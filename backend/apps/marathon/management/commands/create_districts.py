from django.core.management.base import BaseCommand
from apps.marathon.models import District

class Command(BaseCommand):
    help = '创建示例区县数据'

    def handle(self, *args, **options):
        """创建示例区县数据"""
        
        # 区县数据（代码格式：城市代码+区县代码）
        districts_data = [
            # 北京市
            ('110101', '东城区', '110100'),
            ('110102', '西城区', '110100'),
            ('110105', '朝阳区', '110100'),
            ('110106', '丰台区', '110100'),
            ('110108', '海淀区', '110100'),
            # 上海市
            ('310101', '黄浦区', '310100'),
            ('310104', '徐汇区', '310100'),
            ('310105', '长宁区', '310100'),
            ('310106', '静安区', '310100'),
            ('310115', '浦东新区', '310100'),
            # 广州市
            ('440103', '荔湾区', '440100'),
            ('440104', '越秀区', '440100'),
            ('440105', '海珠区', '440100'),
            ('440106', '天河区', '440100'),
            ('440111', '白云区', '440100'),
            ('440112', '黄埔区', '440100'),
            ('440113', '番禺区', '440100'),
            # 深圳市
            ('440303', '罗湖区', '440300'),
            ('440304', '福田区', '440300'),
            ('440305', '南山区', '440300'),
            ('440306', '宝安区', '440300'),
            ('440307', '龙岗区', '440300'),
            # 成都市
            ('510104', '锦江区', '510100'),
            ('510105', '青羊区', '510100'),
            ('510106', '金牛区', '510100'),
            ('510107', '武侯区', '510100'),
            ('510108', '成华区', '510100'),
            # 杭州市
            ('330102', '上城区', '330100'),
            ('330103', '下城区', '330100'),
            ('330104', '江干区', '330100'),
            ('330105', '拱墅区', '330100'),
            ('330106', '西湖区', '330100'),
            # 厦门市
            ('350203', '思明区', '350200'),
            ('350205', '海沧区', '350200'),
            ('350206', '湖里区', '350200'),
            ('350211', '集美区', '350200'),
            ('350212', '同安区', '350200'),
            ('350213', '翔安区', '350200'),
            # 无锡市
            ('320205', '锡山区', '320200'),
            ('320206', '惠山区', '320200'),
            ('320211', '滨湖区', '320200'),
            ('320213', '梁溪区', '320200'),
            ('320214', '新吴区', '320200'),
        ]
        
        # 创建区县
        created_count = 0
        for code, name, city_code in districts_data:
            # 查找城市
            from apps.marathon.models import City
            try:
                city = City.objects.get(code=city_code)
                # 检查是否已存在
                if not District.objects.filter(code=code).exists():
                    District.objects.create(code=code, name=name, city=city)
                    created_count += 1
                    self.stdout.write(f'创建区县: {city.name} - {name}')
            except City.DoesNotExist:
                self.stdout.write(self.style.WARNING(f'未找到城市代码: {city_code}'))
        
        self.stdout.write(self.style.SUCCESS(f'成功创建 {created_count} 个区县'))
