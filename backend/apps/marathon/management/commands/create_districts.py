from django.core.management.base import BaseCommand
from apps.marathon.models import District

class Command(BaseCommand):
    help = '创建完整的区县数据（主要城市）'

    def handle(self, *args, **options):
        """创建完整的区县数据"""
        
        # 完整的区县数据（主要城市）
        districts_data = [
            # 北京市（16个区）
            ('110101', '东城区', '110100'),
            ('110102', '西城区', '110100'),
            ('110105', '朝阳区', '110100'),
            ('110106', '丰台区', '110100'),
            ('110107', '石景山区', '110100'),
            ('110108', '海淀区', '110100'),
            ('110109', '门头沟区', '110100'),
            ('110111', '房山区', '110100'),
            ('110112', '通州区', '110100'),
            ('110113', '顺义区', '110100'),
            ('110114', '昌平区', '110100'),
            ('110115', '大兴区', '110100'),
            ('110116', '怀柔区', '110100'),
            ('110117', '平谷区', '110100'),
            ('110118', '密云区', '110100'),
            ('110119', '延庆区', '110100'),
            # 天津市（16个区）
            ('120101', '和平区', '120100'),
            ('120102', '河东区', '120100'),
            ('120103', '河西区', '120100'),
            ('120104', '南开区', '120100'),
            ('120105', '河北区', '120100'),
            ('120106', '红桥区', '120100'),
            ('120110', '东丽区', '120100'),
            ('120111', '西青区', '120100'),
            ('120112', '津南区', '120100'),
            ('120113', '北辰区', '120100'),
            ('120114', '武清区', '120100'),
            ('120115', '宝坻区', '120100'),
            ('120116', '滨海新区', '120100'),
            ('120117', '宁河区', '120100'),
            ('120118', '静海区', '120100'),
            ('120119', '蓟州区', '120100'),
            # 上海市（16个区）
            ('310101', '黄浦区', '310100'),
            ('310104', '徐汇区', '310100'),
            ('310105', '长宁区', '310100'),
            ('310106', '静安区', '310100'),
            ('310107', '普陀区', '310100'),
            ('310109', '虹口区', '310100'),
            ('310110', '杨浦区', '310100'),
            ('310112', '闵行区', '310100'),
            ('310113', '宝山区', '310100'),
            ('310114', '嘉定区', '310100'),
            ('310115', '浦东新区', '310100'),
            ('310116', '金山区', '310100'),
            ('310117', '松江区', '310100'),
            ('310118', '青浦区', '310100'),
            ('310120', '奉贤区', '310100'),
            ('310151', '崇明区', '310100'),
            # 重庆市（38个区县）
            ('500101', '万州区', '500100'),
            ('500102', '涪陵区', '500100'),
            ('500103', '渝中区', '500100'),
            ('500104', '大渡口区', '500100'),
            ('500105', '江北区', '500100'),
            ('500106', '沙坪坝区', '500100'),
            ('500107', '九龙坡区', '500100'),
            ('500108', '南岸区', '500100'),
            ('500109', '北碚区', '500100'),
            ('500110', '綦江区', '500100'),
            ('500111', '大足区', '500100'),
            ('500112', '渝北区', '500100'),
            ('500113', '巴南区', '500100'),
            ('500114', '黔江区', '500100'),
            ('500115', '长寿区', '500100'),
            ('500116', '江津区', '500100'),
            ('500117', '合川区', '500100'),
            ('500118', '永川区', '500100'),
            ('500119', '南川区', '500100'),
            ('500120', '璧山区', '500100'),
            ('500151', '铜梁区', '500100'),
            ('500152', '潼南区', '500100'),
            ('500153', '荣昌区', '500100'),
            ('500154', '开州区', '500100'),
            ('500155', '梁平区', '500100'),
            ('500156', '武隆区', '500100'),
            # 广州市（11个区）
            ('440103', '荔湾区', '440100'),
            ('440104', '越秀区', '440100'),
            ('440105', '海珠区', '440100'),
            ('440106', '天河区', '440100'),
            ('440111', '白云区', '440100'),
            ('440112', '黄埔区', '440100'),
            ('440113', '番禺区', '440100'),
            ('440114', '花都区', '440100'),
            ('440115', '南沙区', '440100'),
            ('440117', '从化区', '440100'),
            ('440118', '增城区', '440100'),
            # 深圳市（10个区）
            ('440303', '罗湖区', '440300'),
            ('440304', '福田区', '440300'),
            ('440305', '南山区', '440300'),
            ('440306', '宝安区', '440300'),
            ('440307', '龙岗区', '440300'),
            ('440308', '盐田区', '440300'),
            ('440309', '龙华区', '440300'),
            ('440310', '坪山区', '440300'),
            ('440311', '光明区', '440300'),
            ('440312', '大鹏新区', '440300'),
            # 成都市（12个区）
            ('510104', '锦江区', '510100'),
            ('510105', '青羊区', '510100'),
            ('510106', '金牛区', '510100'),
            ('510107', '武侯区', '510100'),
            ('510108', '成华区', '510100'),
            ('510112', '龙泉驿区', '510100'),
            ('510113', '青白江区', '510100'),
            ('510114', '新都区', '510100'),
            ('510115', '温江区', '510100'),
            ('510116', '双流区', '510100'),
            ('510117', '郫都区', '510100'),
            ('510118', '新津区', '510100'),
            # 杭州市（10个区）
            ('330102', '上城区', '330100'),
            ('330105', '拱墅区', '330100'),
            ('330106', '西湖区', '330100'),
            ('330108', '滨江区', '330100'),
            ('330109', '萧山区', '330100'),
            ('330110', '余杭区', '330100'),
            ('330111', '富阳区', '330100'),
            ('330112', '临安区', '330100'),
            ('330113', '临平区', '330100'),
            ('330114', '钱塘区', '330100'),
            # 南京市（11个区）
            ('320102', '玄武区', '320100'),
            ('320104', '秦淮区', '320100'),
            ('320105', '建邺区', '320100'),
            ('320106', '鼓楼区', '320100'),
            ('320111', '浦口区', '320100'),
            ('320113', '栖霞区', '320100'),
            ('320114', '雨花台区', '320100'),
            ('320115', '江宁区', '320100'),
            ('320116', '六合区', '320100'),
            ('320117', '溧水区', '320100'),
            ('320118', '高淳区', '320100'),
            # 苏州市（5个区）
            ('320505', '虎丘区', '320500'),
            ('320506', '吴中区', '320500'),
            ('320507', '相城区', '320500'),
            ('320508', '姑苏区', '320500'),
            ('320509', '吴江区', '320500'),
            # 武汉市（13个区）
            ('420102', '江岸区', '420100'),
            ('420103', '江汉区', '420100'),
            ('420104', '硚口区', '420100'),
            ('420105', '汉阳区', '420100'),
            ('420106', '武昌区', '420100'),
            ('420107', '青山区', '420100'),
            ('420111', '洪山区', '420100'),
            ('420112', '东西湖区', '420100'),
            ('420113', '汉南区', '420100'),
            ('420114', '蔡甸区', '420100'),
            ('420115', '江夏区', '420100'),
            ('420116', '黄陂区', '420100'),
            ('420117', '新洲区', '420100'),
            # 西安市（11个区）
            ('610102', '新城区', '610100'),
            ('610103', '碑林区', '610100'),
            ('610104', '莲湖区', '610100'),
            ('610111', '灞桥区', '610100'),
            ('610112', '未央区', '610100'),
            ('610113', '雁塔区', '610100'),
            ('610114', '阎良区', '610100'),
            ('610115', '临潼区', '610100'),
            ('610116', '长安区', '610100'),
            ('610117', '高陵区', '610100'),
            ('610118', '鄠邑区', '610100'),
            # 郑州市（6个区）
            ('410102', '中原区', '410100'),
            ('410103', '二七区', '410100'),
            ('410104', '管城回族区', '410100'),
            ('410105', '金水区', '410100'),
            ('410106', '上街区', '410100'),
            ('410108', '惠济区', '410100'),
            # 长沙市（6个区）
            ('430102', '芙蓉区', '430100'),
            ('430103', '天心区', '430100'),
            ('430104', '岳麓区', '430100'),
            ('430105', '开福区', '430100'),
            ('430111', '雨花区', '430100'),
            ('430112', '望城区', '430100'),
            # 厦门市（6个区）
            ('350203', '思明区', '350200'),
            ('350205', '海沧区', '350200'),
            ('350206', '湖里区', '350200'),
            ('350211', '集美区', '350200'),
            ('350212', '同安区', '350200'),
            ('350213', '翔安区', '350200'),
            # 无锡市（5个区）
            ('320205', '锡山区', '320200'),
            ('320206', '惠山区', '320200'),
            ('320211', '滨湖区', '320200'),
            ('320213', '梁溪区', '320200'),
            ('320214', '新吴区', '320200'),
        ]
        
        # 创建区县
        from apps.marathon.models import City
        created_count = 0
        for code, name, city_code in districts_data:
            # 查找城市
            try:
                city = City.objects.get(code=city_code)
                # 使用get_or_create避免重复创建
                district, created = District.objects.get_or_create(
                    code=code,
                    defaults={'name': name, 'city': city}
                )
                if created:
                    created_count += 1
                    self.stdout.write(f'创建区县: {city.name} - {name}')
            except City.DoesNotExist:
                self.stdout.write(self.style.WARNING(f'未找到城市代码: {city_code}，跳过区县: {name}'))
        
        self.stdout.write(self.style.SUCCESS(f'成功创建/更新 {created_count} 个区县，共 {len(districts_data)} 个区县'))
